<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="author" content="#">
    <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet" />
    <link href="css/ratings.css" rel="stylesheet" />
    <link href="css/main.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
    <script src="js/ratings.js"></script>
  </head>
  <body>
    <div class="s01">
      <form>
        <fieldset>
          <legend>Text to Voice Conversion</legend>
        </fieldset>
        <div class="inner-form">
          <div class="input-field first-wrap">
            <input id="search" type="text" placeholder="Share your thoughts here!"/>
          </div>
        </div>
        <div class="text-center" style="margin-top:10px;">
          <button type="button" class="btn btn-success btn-lg" id="speechplay" onclick="textToVoice()">Play</button>
          <button type="button" class="btn btn-primary btn-lg" id="speechpause" onclick="onClickPause()">Pause</button>
          <button type="button" class="btn btn-danger btn-lg" data-bs-toggle="modal" data-bs-target="#reviewsModal" id="speechstop">Stop</button>
      </div>
      <div class="d-flex justify-content-center"  style="margin-top:10px;">
      <div class="form-check"  style="background: rgba(0, 0, 0, 0.5);margin-right:10px;">
        <input class="form-check-input" type="radio" name="voiceRadio" id="voiceRadio1" value="en-EN" checked style="transform: scale(1.5);">
        <label class="form-check-label" for="voiceRadio1" style="color: #fff;">
          Voice 1
        </label>
      </div>
      <div class="form-check"  style="background: rgba(0, 0, 0, 0.5);margin-left:10px;">
        <input class="form-check-input" type="radio" name="voiceRadio" id="voiceRadio2" value="hi-IN" style="transform: scale(1.5);">
        <label class="form-check-label" for="voiceRadio2" style="color: #fff;">
          Voice 2
        </label>
      </div>
    </div>
      </form>
    </div>
    <div class="s02">

    </div>
    <div class="modal fade" id="reviewsModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Rate your Experience.</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <section class='rating-widget'>
              <!-- Rating Stars Box -->
              <div class='rating-stars text-center'>
                <ul id='stars'>
                  <li class='star' title='Poor' data-value='1'>
                    <i class='fa fa-star fa-fw'></i>
                  </li>
                  <li class='star' title='Fair' data-value='2'>
                    <i class='fa fa-star fa-fw'></i>
                  </li>
                  <li class='star' title='Good' data-value='3'>
                    <i class='fa fa-star fa-fw'></i>
                  </li>
                  <li class='star' title='Excellent' data-value='4'>
                    <i class='fa fa-star fa-fw'></i>
                  </li>
                  <li class='star' title='WOW!!!' data-value='5'>
                    <i class='fa fa-star fa-fw'></i>
                  </li>
                </ul>
              </div>
              
              <div class='success-box'>
                <div class='clearfix'></div>
                <img alt='tick image' width='32' src='data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA0MjYuNjY3IDQyNi42NjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQyNi42NjcgNDI2LjY2NzsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxwYXRoIHN0eWxlPSJmaWxsOiM2QUMyNTk7IiBkPSJNMjEzLjMzMywwQzk1LjUxOCwwLDAsOTUuNTE0LDAsMjEzLjMzM3M5NS41MTgsMjEzLjMzMywyMTMuMzMzLDIxMy4zMzMgIGMxMTcuODI4LDAsMjEzLjMzMy05NS41MTQsMjEzLjMzMy0yMTMuMzMzUzMzMS4xNTcsMCwyMTMuMzMzLDB6IE0xNzQuMTk5LDMyMi45MThsLTkzLjkzNS05My45MzFsMzEuMzA5LTMxLjMwOWw2Mi42MjYsNjIuNjIyICBsMTQwLjg5NC0xNDAuODk4bDMxLjMwOSwzMS4zMDlMMTc0LjE5OSwzMjIuOTE4eiIvPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K'/>
                <div class='text-message'></div>
                <input id="ratingValue" style="display:none" type="text" value="1.0"/> 
                <div class='clearfix'></div>
              </div>  
            </section>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="submitLog()">Close</button>
            <button type="button" class="btn btn-primary" onclick="submitLog()">Save changes</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<script type="text/javascript">
  var voices;
  var flag=0; //no utterance
  
  window.onload = function(){
	 voices = window.speechSynthesis.getVoices();
   console.log(voices); 
	   var urls = ['./images/Search_001.png', './images/Search_002.png', './images/Search_003.png', './images/Search_004.png'];
	   var cout = 1;
       $('.s01').css('background', 'url("' + urls[0] + '")');
      setInterval(function() {
      $('.s01').css('background', 'url("' + urls[cout] + '")');
      cout == urls.length-1 ? cout = 0 : cout++;
  }, 5000);
	 
  }
  function textToVoice()
  {
    if(flag==0){
      var text = $("#search").val();
      if(text.trim()!=""){
      var msg = new SpeechSynthesisUtterance();
      var text = $("#search").val();
      //var lan = 'en-EN';
      //var lan = 'hi-IN';
      var lan = $('input[name="voiceRadio"]:checked').val();
      $('input[name=voiceRadio]').attr("disabled",true);
      msg.voice = voices[10]; // Note: some voices don't support altering params
      msg.voiceURI = 'native';
      msg.volume = 1; // 0 to 1
      msg.rate = 1; // 0.1 to 10
      msg.pitch = 1; //0 to 2
      msg.text = text;
      //msg.lang = 'hi-IN';
      msg.lang = lan;
      msg.onend = function(e) {
        console.log('Finished in ' + event.elapsedTime + ' seconds.');
        //location.reload();
      };

      speechSynthesis.speak(msg); 
      flag=1; 
      }else{
        alert("Text Fileld empty Enter Text for voice conversion.");
      }
    }else{
      speechSynthesis.resume();
    }
    
}
  function submitLog(){
    var textmsg = $('#search').val();
    var rating = $('#ratingValue').val();
    if(textmsg.trim()!=""){
      $.post( 
                  "http://localhost:8011/api/auditlogs",
                  { 'inputText': textmsg , 'rating': rating},
                  function(data) {
                     $('#s02').html(data);
                  }
               );
    }else{
      alert("Text Fileld empty Enter Text for voice conversion.");
    }
    $("#reviewsModal").modal('hide');
    $("#search").val("");
    flag=0;
    $('input[name=voiceRadio]').attr("disabled",false);
	  speechSynthesis.cancel(); 	  
  }

  function onClickPause(){
    speechSynthesis.pause();
  }
</script>